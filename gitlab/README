Create objects.

    oc create -f deploy.yaml

Replace volumes.

    oc set volume deploymentconfig/gitaly --add \
        --name git --overwrite \
        --type persistentVolumeClaim --claim-name git
    oc set volume deploymentconfig/gitaly --add \
        --name etc --overwrite \
        --type persistentVolumeClaim --claim-name etc
    oc set volume deploymentconfig/workhorse --add \
        --name etc --overwrite \
        --type persistentVolumeClaim --claim-name etc
    oc set volume deploymentconfig/unicorn --add \
        --name etc --overwrite \
        --type persistentVolumeClaim --claim-name etc
    oc set volume deploymentconfig/sidekiq --add \
        --name etc --overwrite \
        --type persistentVolumeClaim --claim-name etc

Build.

    oc start-build --wait redis &
    oc start-build --wait gitaly &
    oc start-build --wait unicorn &
    wait

Deploy.

    oc rollout latest deploymentconfig/redis
    oc rollout latest deploymentconfig/gitaly
    oc rollout latest deploymentconfig/unicorn
    oc rollout latest deploymentconfig/sidekiq
    oc rollout latest deploymentconfig/workhorse

Create route.

    oc create route edge \
        --hostname gitlab.example.com \
        --service workhorse
